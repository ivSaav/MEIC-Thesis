\chapter{Introduction} \label{chap:intro}

The Sun continuously releases a stream of particles known as \textit{solar wind}. This stream consisting of high-velocity charged particles (e.g. protons and electrons) can reach planetary surfaces unless thwarted by an atmosphere, magnetic ﬁeld, or both. In Earth's case, the magnetosphere and the atmosphere, to a smaller extent, block out most of the radiation emitted by the Sun. However, other more extreme events like solar flares and CMEs (Coronal Mass Ejections) can provoke negative effects on the Earth's surface and upper atmosphere. 

These events can impact the Earth in three primary ways. Firstly, they can cause radio blackouts that predominantly affect satellites and, consequently, geolocation and communication systems. Secondly, solar radiation storms can endanger astronauts and spacecraft orbiting the Earth. Lastly, the most severe of these events are geomagnetic storms, which have historically caused significant disturbances. Examples of such disturbances include the Carrington Event in 1859 and a geomagnetic storm that affected Quebec's power grid in 1989\footnote{List of solar storms: \url{https://en.wikipedia.org/wiki/List_of_solar_storms}}.

Space Weather Science is a field that aims to prevent the consequences of such events; however, the factors that result in their formation are still not fully understood. Some simulation models have been designed to try and fill this gap \cite{pinto.rouillard_MultipleFluxtubeSolar_2017, odstrcil.pizzo_ThreedimensionalPropagationCoronal_1999}, but they require initial expert guesses. Recently, an ML (Machine Learning) model has been developed \cite{barros_InitialConditionEstimation_} to improve these initial predictions based on known data. Like other ML problems, the quality of the predictions is very dependent on the quality of the training data.

%The field of \textit{Space Weather Science} emerged with the aim of understanding the formation of the phenomena that could affect Earth, in order to implement early warning systems. Despite this being a well-developed field of science, the correlations between the Sun's structures and these phenomena are not yet fully formulated and their prediction is mostly speculative. Several simulations have been developed to try and fill this gap (e.g. MULTI-VP \cite{pinto.rouillard_MultipleFluxtubeSolar_2017}). These models require initial estimations before starting the simulation and their performance is affected by the quality of these initial values.

%Several simulation models have been developed recently to try and estimate these conditions with data collected from satellites, probes and observatories. 

\section{Motivation} \label{sec:motivation}
In 1859, Carrington recorded the first and largest known solar flare in history, which is now commonly referred to as the Carrington event. This phenomenon was so extreme that it caused geomagnetic storms in unexpected latitudes and provoked fires on telegraph wires.  Carrington was also able to correlate the event with a geomagnetic storm that occurred several hours later. His pioneering work is widely recognized as the inception of the scientific discipline known as Space Weather \cite{schwenn_SpaceWeatherSolar_2006}.

The field of \textit{Space Weather Science} emerged with the aim of understanding the formation of phenomena that could affect Earth to evaluate their effects and to create early warning systems. Despite significant advancements in this scientific field, the correlations between the Sun's structures and these phenomena are not yet fully formulated and are mostly speculative.  For instance, it is still unknown why the atmosphere of the Sun is considerately hotter than its surface. The main leading theory is that the magnetic field transports energy deep from the convection zone through the surface and up to the atmosphere. It is also posited that the magnetic fields on the surface sometimes collide, provoking large explosions and therefore causing the atmosphere to heat even further. Another enigma is the acceleration of the solar wind (up to millions of miles) out of the corona. Some correlation between the magnetic field and solar wind acceleration has been found; however, the effect remains a mystery.

The answer to questions like these can contribute to a greater understanding of the underlying processes of the Sun that influence solar weather. Consequently, predicting future events that could impact the Earth, satellites, and space stations orbiting it would become easier. Thus far, these answers have been delayed by the technological limitations on measuring solar events. In 2018, NASA's Parker Solar \footnote{Parker Solar Probe: Humanity’s First Visit to a Star \url{https://www.nasa.gov/content/goddard/parker-solar-probe-humanity-s-first-visit-to-a-star}} probe was launched on a mission to orbit the Sun's, to understand the acceleration of solar wind at the corona. More recently, ESA launched the Solar Orbiter to measure the solar wind and record images of the uncharted polar regions, closer than every other solar probe\footnote{ESA: Solar Orbiter \url{https://www.esa.int/Science_Exploration/Space_Science/Solar_Orbiter}}. The PUNCH\footnote{NASA Selects Missions to Study Our Sun, Its Effects on Space Weather \url{https://www.nasa.gov/press-release/nasa-selects-missions-to-study-our-sun-its-effects-on-space-weather}} mission was launched to try and shed some light on the formation of the solar wind on the Sun's surface.

MHD (magnetohydrodynamic) simulators like MULTI-VP \cite{pinto.rouillard_MultipleFluxtubeSolar_2017} and ENLIL \cite{odstrcil.pizzo_ThreedimensionalPropagationCoronal_1999}, were developed in order to try and extrapolate coronal conditions from limited observations of solar events from probes and observatories. The execution of these simulations relies on initial estimations, usually performed by hand after an analysis of the data (a very time-consuming task). Additionally, it has been posited that good initial estimations have the potential to reduce the simulation's execution time significantly. The process of making the initial predictions as well as the extensive execution time of the simulations make it difficult to create early warning systems that can prevent the effects of solar events on Earth.

\section{Problem Definition} \label{sec:prob_definition}
The exponential growth of data acquisition has presented a significant challenge in promptly analyzing the vast amount of available information. The sheer amount of data is becoming increasingly hard for researchers to process, especially on data linked to near-real-time utilization. Machine learning has become one of the main methods of evaluating the data efficiently for problems associated with space weather prediction. However, most deep learning models are very susceptible to large variations in the data that can severely decrease the performance of these models. The anomalies can originate from the instrument and detector noise, statistical noise from the small flux of photons, and external noise may include instrumentation jitter, stray starlight, and cosmic ray background \cite{anirudh2022ReviewDataDriven2022}.

Recently, a NN \cite{barros_InitialConditionEstimation_} was developed to perform initial estimations for solar wind profiles that would later be fed to MULTI-VP \cite{pinto.rouillard_MultipleFluxtubeSolar_2017}. This reduced the time needed to generate the initial estimations required by the simulation, which were previously done by hand. Additionally, it was observed that producing initial estimates closer to the final simulation reduced the computation time of the simulation, with a mean speedup of 1.06. Despite this, it was concluded that the prediction model was not producing the best possible estimates. On one hand, this might have been because the model managed to learn the most concentrated observations and failed to learn the ones in the peripheries. Another possibility is that the existence of anomalies in the dataset was hindering the performance of the model resulting in worse estimates.

The problem addressed in this thesis is to enhance the quality of the training data, which is then to be used for predicting initial conditions associated with solar wind behaviour.

\section{Goals}\label{sec:goals}
This thesis aims to enhance the prediction ability of the neural network \cite{barros_InitialConditionEstimation_} responsible for generating initial predictions for solar wind formations. With this, we aim to produce closer initial condition estimations to MULTI-VP's \cite{pinto.rouillard_MultipleFluxtubeSolar_2017} final estimates. We intend to achieve this by:

\begingroup
    \renewcommand\labelenumi{(\theenumi)}
    \begin{enumerate}
    \item applying clustering techniques in the training of the models for initial condition prediction so these can better capture the features of the data;
    \item applying adversarial anomaly detection techniques to detect and filter faulty measurements in the data used to train the prediction models.
\end{enumerate}
\endgroup


As a consequence of better initial condition estimations, we intend to reduce the computation time that the simulation takes to reach a viable solution.



% The objective of this thesis is to take advantage of GANs' generative and discriminative abilities to identify anomalous input data within solar wind profiles. The  identified anomalous data points will be excluded  from the input provided to a neural network (NN) model \cite{barros_InitialConditionEstimation_} responsible for generating initial predictions for solar wind formation. This approach aims to improve the accuracy of the NN model's predictions and, consequently, reduce the computation time required by MULTI-VP \cite{pinto.rouillard_MultipleFluxtubeSolar_2017} to generate feasible solutions.

% The developed architecture should be able to generate new solar wind profiles similar to the real distribution and to correctly detect samples that fall out of that distribution.
\clearpage
\section{Document Structure}\label{sec:doc_struct}
This first chapter has provided the context for the problem addressed in this dissertation. The remaining sections of the document are organized as follows:

\begin{itemize}
    \item Chapter \ref{chap:background}, explains the background needed to understand the current problems in the area of space weather science. Some concepts related to neural networks and anomalies are also introduced to provide a basis for methods discussed in the remainder of the document.

    \item Chapter \ref{chap:sota}, provides an analysis o fthe current state-of-the-art methods for clustering and adversarial anomaly detection.

    \item Chapter \ref{chap:research_proposal}, goes into more depth on the problem this thesis aims to solve and the approach that will be taken.

    % \item Chapter \ref{chap:eda}, explains the dataset that will be used throughout this thesis.

    \item Chapter \ref{chap:clustering} explains the clustering methods used on the dataset, followed by the experiments and discussion of the results.

    \item Chapter \ref{chap:aad} starts by explaining the origins of adversarial learning and the experiments undertaken with this type of approach, followed by a brief discussion of the results.

    \item Chapter \ref{chap:remarks} evaluates this thesis's hypothesis and provides a brief conclusion for the work carried out.
\end{itemize}

% hipotese - retirar outliers para o processo de aprendizagem ser melhor